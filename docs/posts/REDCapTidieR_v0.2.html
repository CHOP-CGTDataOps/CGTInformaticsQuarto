<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Stephan Kadauke, Ezra Porter, Richard Hanna">

<title>CGT Informatics - REDCapTidieR 0.2.0</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../index.html">
    <img src="../img/cgt_informatics_bg_removed.png" alt="">
    <span class="navbar-title">CGT Informatics</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html">About</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../posts.html">Posts</a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/CHOP-CGTDataOps"><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#expanding-the-supertibble-introducing-metadata" id="toc-expanding-the-supertibble-introducing-metadata" class="nav-link active" data-scroll-target="#expanding-the-supertibble-introducing-metadata">Expanding the Supertibble: Introducing Metadata</a></li>
  <li><a href="#new-read_redcap_tidy-arguments" id="toc-new-read_redcap_tidy-arguments" class="nav-link" data-scroll-target="#new-read_redcap_tidy-arguments">New <code>read_redcap_tidy</code> Arguments</a>
  <ul class="collapse">
  <li><a href="#support-for-survey-fields" id="toc-support-for-survey-fields" class="nav-link" data-scroll-target="#support-for-survey-fields">Support for Survey Fields</a></li>
  </ul></li>
  <li><a href="#introducing-make_labelled" id="toc-introducing-make_labelled" class="nav-link" data-scroll-target="#introducing-make_labelled">Introducing <code>make_labelled</code></a></li>
  <li><a href="#performance-improvements-and-enhancements" id="toc-performance-improvements-and-enhancements" class="nav-link" data-scroll-target="#performance-improvements-and-enhancements">Performance Improvements and Enhancements</a></li>
  <li><a href="#various-bug-fixes" id="toc-various-bug-fixes" class="nav-link" data-scroll-target="#various-bug-fixes">Various Bug Fixes</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">REDCapTidieR 0.2.0</h1>
<p class="subtitle lead">Introducing numerous feature enhancements and improvements</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Stephan Kadauke, Ezra Porter, Richard Hanna </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<p>We’re thrilled to announce the release of <a href="https://chop-cgtdataops.github.io/REDCapTidieR/"><code>REDCapTidieR</code></a> v0.2.0 on CRAN. <code>REDCapTidieR</code> provides an elegant way to import data from a <a href="https://www.project-redcap.org/">REDCap</a> database into an R environment.</p>
<p><code>REDCapTidieR</code> is led by a primary function, <code>read_redcap_tidy</code>, built on top of the streamlined API extraction processes provided by the <a href="https://ouhscbbmc.github.io/REDCapR/"><code>REDCapR</code></a> package. <code>read_redcap_tidy</code> does all the laborious work of taking complex REDCap databases and transforming them into manageable, tidy tables for easier processing with less start up time for analysts. The output provided is referred to as the <strong>supertibble</strong>, since the REDCap data is provided in a “<code>tibble</code> of <code>tibble</code>s”. In a supertibble output, each row represents a REDCap form/instrument containing a <strong>list column</strong> of the associated <code>tibble</code>.</p>
<section id="expanding-the-supertibble-introducing-metadata" class="level2">
<h2 class="anchored" data-anchor-id="expanding-the-supertibble-introducing-metadata">Expanding the Supertibble: Introducing Metadata</h2>
<p>One of the primary advancements of <code>REDCapTidieR</code> in <code>v0.2.0</code> will be immediately apparent when viewing a supertibble output:</p>
<div class="cell" data-hash="REDCapTidieR_v0.2_cache/html/display supertibble_52a6de80de6c0954206f8613606e3099">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(REDCapTidieR)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>superheroes_tidy <span class="ot">&lt;-</span> <span class="fu">read_redcap_tidy</span>(redcap_uri, token)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>superheroes_tidy <span class="sc">%&gt;%</span> </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 2
Columns: 9
$ redcap_form_name  &lt;chr&gt; "heroes_information", "super_hero_powers"
$ redcap_form_label &lt;chr&gt; "Heroes Information", "Super Hero Powers"
$ redcap_data       &lt;list&gt; [&lt;tbl_df[734 x 12]&gt;], [&lt;tbl_df[5966 x 4]&gt;]
$ redcap_metadata   &lt;list&gt; [&lt;tbl_df[11 x 16]&gt;], [&lt;tbl_df[2 x 16]&gt;]
$ structure         &lt;chr&gt; "nonrepeating", "repeating"
$ data_rows         &lt;int&gt; 734, 5966
$ data_cols         &lt;int&gt; 12, 4
$ data_size         &lt;lbstr_by&gt; 123.24 kB, 180.21 kB
$ data_na_pct       &lt;dbl&gt; 0.002316076, 0.000000000</code></pre>
</div>
</div>
<p>Where in <code>0.1</code> the supertibble only provided three columns, we now have access to <strong>six</strong> new ones. These include:</p>
<ul>
<li><code>redcap_form_label</code>: The form label that corresponds to the form name</li>
<li><code>redcap_metadata</code>: REDCap metadata associated with the form</li>
<li><code>data_rows</code>/<code>data_cols</code>: Row and column counts</li>
<li><code>data_size</code>: Size of the <code>redcap_data</code> corresponding to the form, given in <a href="https://lobstr.r-lib.org/"><code>lobstr_bytes</code></a></li>
<li><code>data_na_pct</code>: The percentage of missing data in the corresponding <code>redcap_data</code></li>
</ul>
</section>
<section id="new-read_redcap_tidy-arguments" class="level2">
<h2 class="anchored" data-anchor-id="new-read_redcap_tidy-arguments">New <code>read_redcap_tidy</code> Arguments</h2>
<p>To enhance and expand the capabilities of <code>read_redcap_tidy</code>, we’ve introduced two new arguments to pass to the API:</p>
<ul>
<li><code>forms</code></li>
<li><code>export_survey_fields</code></li>
</ul>
<p>You can now call specific <code>forms</code> from your database instead of defaulting to downloading the entire dataset. This can be especially useful for very large databases where full data downloads take up needless memory.</p>
<div class="cell" data-hash="REDCapTidieR_v0.2_cache/html/forms example_b244812831881f41ddfd8fd2ed12a26c">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>superheroes_powers <span class="ot">&lt;-</span> <span class="fu">read_redcap_tidy</span>(redcap_uri, </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                                       token, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">forms =</span> <span class="st">"super_hero_powers"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>superheroes_powers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 9
  redcap_for…¹ redca…² redcap…³ redcap…⁴ struc…⁵ data_…⁶ data_…⁷ data_…⁸ data_…⁹
  &lt;chr&gt;        &lt;chr&gt;   &lt;list&gt;   &lt;list&gt;   &lt;chr&gt;     &lt;int&gt;   &lt;int&gt; &lt;lbstr&gt;   &lt;dbl&gt;
1 super_hero_… Super … &lt;tibble&gt; &lt;tibble&gt; repeat…    5966       4 180.21…       0
# … with abbreviated variable names ¹​redcap_form_name, ²​redcap_form_label,
#   ³​redcap_data, ⁴​redcap_metadata, ⁵​structure, ⁶​data_rows, ⁷​data_cols,
#   ⁸​data_size, ⁹​data_na_pct</code></pre>
</div>
</div>
<section id="support-for-survey-fields" class="level3">
<h3 class="anchored" data-anchor-id="support-for-survey-fields">Support for Survey Fields</h3>
<p>We have also included default survey fields from the API:</p>
<ul>
<li><code>[instrument_name]_timestamp</code></li>
<li><code>redcap_survey_identifier</code></li>
</ul>
<p>By default, these will appear for survey projects but can be turned off if desired by setting <code>export_survey_fields</code> to <code>FALSE</code>. Please refer to the REDCap documentation regarding behavior of these fields, especially survey identifiers as they require databases to be set up in special ways.</p>
<div class="cell" data-hash="REDCapTidieR_v0.2_cache/html/survey example_8748c4ca120964480ae5829e4e03bf36">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>survey_database <span class="ot">&lt;-</span> <span class="fu">read_redcap_tidy</span>(redcap_uri,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                                    survey_token,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">forms =</span> <span class="st">"survey"</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">export_survey_fields =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>survey_database<span class="sc">$</span>redcap_data[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 4
Columns: 9
$ record_id                &lt;dbl&gt; 1, 2, 3, 4
$ survey_yesno             &lt;lgl&gt; TRUE, FALSE, NA, NA
$ survey_radio             &lt;fct&gt; Choice 1, Choice 2, NA, NA
$ survey_checkbox___one    &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE
$ survey_checkbox___two    &lt;lgl&gt; TRUE, TRUE, FALSE, FALSE
$ survey_checkbox___three  &lt;lgl&gt; TRUE, TRUE, FALSE, FALSE
$ survey_timestamp         &lt;dttm&gt; 2022-11-09 10:33:35, NA, NA, NA
$ redcap_survey_identifier &lt;lgl&gt; NA, NA, NA, NA
$ form_status_complete     &lt;fct&gt; Complete, Incomplete, Incomplete, Incomplete</code></pre>
</div>
</div>
<p>Note the inclusion of the <code>redcap_survey_identifier</code> and <code>survey_timestamp</code> columns.</p>
</section>
</section>
<section id="introducing-make_labelled" class="level2">
<h2 class="anchored" data-anchor-id="introducing-make_labelled">Introducing <code>make_labelled</code></h2>
<p>WIP</p>
</section>
<section id="performance-improvements-and-enhancements" class="level2">
<h2 class="anchored" data-anchor-id="performance-improvements-and-enhancements">Performance Improvements and Enhancements</h2>
<ul>
<li>Internal function <code>check_repeat_and_nonrepeat</code> optimized</li>
<li>Internal function <code>distill_*_table_long</code> optimized</li>
<li>Internal function <code>multi_choice_to_labels</code> optimized</li>
<li><code>cli</code> implemented for all warnings and errors</li>
<li><code>httptest</code> implementation in tests and vignettes</li>
</ul>
</section>
<section id="various-bug-fixes" class="level2">
<h2 class="anchored" data-anchor-id="various-bug-fixes">Various Bug Fixes</h2>
<ul>
<li><code>extract_*</code> bug fixed to align with new metadata outputs</li>
<li>REDCap <code>form_name</code> order preservation bug fixed</li>
<li><code>tidyselect</code> warnings addressed with <a href="https://tidyselect.r-lib.org/news/index.html#lifecycle-changes-1-2-0"><code>tidyselect v1.2.0</code></a></li>
<li><code>renv</code> CI cacheing enabled for GitHub Actions optimization</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">
        <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Made with ❤️ in Philadelphia
  </li>  
</ul>
      </div>
  </div>
</footer>



</body></html>