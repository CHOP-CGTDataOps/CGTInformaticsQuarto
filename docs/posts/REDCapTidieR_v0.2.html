<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Stephan Kadauke, Ezra Porter, Richard Hanna">
<meta name="dcterms.date" content="2022-12-06">
<meta name="description" content="REDCapTidieR v0.2.0 release announcement and change descriptions.">

<title>REDCapTidieR 0.2.0 ☃️ – Cell and Gene Therapy Informatics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../img/cgt_informatics_bg_removed.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Cell and Gene Therapy Informatics</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../posts.html"> 
<span class="menu-text">Posts</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/CHOP-CGTInformatics"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#new-names-for-functions" id="toc-new-names-for-functions" class="nav-link active" data-scroll-target="#new-names-for-functions">New names for functions</a>
  <ul class="collapse">
  <li><a href="#why-on-earth-would-you-do-that" id="toc-why-on-earth-would-you-do-that" class="nav-link" data-scroll-target="#why-on-earth-would-you-do-that">Why on earth would you do that?!</a></li>
  <li><a href="#why-now" id="toc-why-now" class="nav-link" data-scroll-target="#why-now">Why now?</a></li>
  </ul></li>
  <li><a href="#improved-documentation" id="toc-improved-documentation" class="nav-link" data-scroll-target="#improved-documentation">Improved Documentation</a></li>
  <li><a href="#hello-metadata" id="toc-hello-metadata" class="nav-link" data-scroll-target="#hello-metadata">Hello metadata!</a></li>
  <li><a href="#redcaptidier-labelled" id="toc-redcaptidier-labelled" class="nav-link" data-scroll-target="#redcaptidier-labelled">REDCapTidieR ❤️ labelled</a></li>
  <li><a href="#new-arguments-for-read_redcap" id="toc-new-arguments-for-read_redcap" class="nav-link" data-scroll-target="#new-arguments-for-read_redcap">New arguments for <code>read_redcap()</code></a>
  <ul class="collapse">
  <li><a href="#retrieve-data-from-a-subset-of-instruments" id="toc-retrieve-data-from-a-subset-of-instruments" class="nav-link" data-scroll-target="#retrieve-data-from-a-subset-of-instruments">Retrieve data from a subset of instruments</a></li>
  <li><a href="#support-for-redcap-surveys" id="toc-support-for-redcap-surveys" class="nav-link" data-scroll-target="#support-for-redcap-surveys">Support for REDCap surveys</a></li>
  </ul></li>
  <li><a href="#performance-improvements-and-enhancements" id="toc-performance-improvements-and-enhancements" class="nav-link" data-scroll-target="#performance-improvements-and-enhancements">Performance improvements and enhancements</a></li>
  <li><a href="#bug-fixes" id="toc-bug-fixes" class="nav-link" data-scroll-target="#bug-fixes">Bug fixes</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">REDCapTidieR 0.2.0 ☃️</h1>
  <div class="quarto-categories">
    <div class="quarto-category">REDCap</div>
    <div class="quarto-category">REDCapTidieR</div>
    <div class="quarto-category">R</div>
  </div>
  </div>

<div>
  <div class="description">
    REDCapTidieR v0.2.0 release announcement and change descriptions.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Stephan Kadauke, Ezra Porter, Richard Hanna </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 6, 2022</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>We’re thrilled to announce the release of <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/">REDCapTidieR</a> v0.2.0 on CRAN! REDCapTidieR provides a user-friendly way to <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#import">import</a> data from a <a href="https://www.project-redcap.org/">REDCap</a> <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#project">project</a> into the R environment. You can install the current version from CRAN using <code>install.packages("REDCapTidieR")</code>.</p>
<section id="new-names-for-functions" class="level2">
<h2 class="anchored" data-anchor-id="new-names-for-functions">New names for functions</h2>
<p>We have decided to rename some of the exported functions of our package. Here is what changed:</p>
<ul>
<li><code>read_redcap_tidy()</code> is now <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/reference/read_redcap.html"><strong><code>read_redcap()</code></strong></a></li>
<li><code>bind_tables()</code> is now <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/reference/bind_tibbles.html"><strong><code>bind_tibbles()</code></strong></a></li>
<li><code>extract_table()</code> is now <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/reference/extract_tibble.html"><strong><code>extract_tibble()</code></strong></a></li>
<li><code>extract_tables()</code> is now <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/reference/extract_tibbles.html"><strong><code>extract_tibbles()</code></strong></a></li>
</ul>
<p>We have also cleaned up the API to make the function arguments more consistent.</p>
<p>We are handling each of these name changes with deprecation functions of the <a href="https://lifecycle.r-lib.org/index.html">lifecycle package</a>. This means that you can still use the original function names, but you will receive an annoying alert to switch to the new ones each time you try to use them. At some point in the future we may remove the deprecated functions from the package.</p>
<section id="why-on-earth-would-you-do-that" class="level3">
<h3 class="anchored" data-anchor-id="why-on-earth-would-you-do-that">Why on earth would you do that?!</h3>
<p>We want to design our API so it’s easy to learn and use.</p>
<p>The main function of the package is <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/reference/read_redcap.html"><code>read_redcap()</code></a>, and its name explains exactly what it does: it reads or <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#import">imports</a> data from REDCap. The fact that the object that this function returns (i.e.&nbsp;the <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#supertibble">supertibble</a>) is <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#tidy">tidy</a> is a technical detail.</p>
<p>We replaced “table” with “<a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#tibble">tibble</a>” in the <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#data-tibble">data tibble</a> extraction functions because “tibble” is a more precise term than “table.” Also, this way we are being more consistent in our use of <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html">REDCapTidieR vocabulary</a> such as “<a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#supertibble">supertibble</a>” and “<a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#data-tibble">data tibble</a>”.</p>
<p>We also thought about the names in terms of <strong>teachability</strong>. When you explain how to use the package to someone for the first time, how would you describe the action of each of the functions? For example, how do you read data from REDCap? With <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/reference/read_redcap.html"><code>read_redcap()</code></a>. How do you extract a <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#data-tibble">data tibble</a> from the <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#supertibble">supertibble</a>? With <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/reference/extract_tibble.html"><code>extract_tibble()</code></a>. Or if you’d rather bind the tibbles to your <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#environment">environment</a>, use <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/reference/bind_tibbles.html"><code>bind_tibbles()</code></a>.</p>
</section>
<section id="why-now" class="level3">
<h3 class="anchored" data-anchor-id="why-now">Why now?</h3>
<p>REDCapTidieR is still very new and there doesn’t yet exist much code that depends on it (we hope this will change!). The cost of fixing things is low now compared to later on.</p>
</section>
</section>
<section id="improved-documentation" class="level2">
<h2 class="anchored" data-anchor-id="improved-documentation">Improved Documentation</h2>
<p>We’ve been hard at work writing up extensive <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/index.html">documentation</a> to support new users in adopting REDCapTidieR. The <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/REDCapTidieR.html">Getting Started vignette</a> walks new users through <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#import">importing</a> data from REDCap into a <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#supertibble">supertibble</a>, exploring the contents of the supertibble in the <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#data-viewer">RStudio Data Viewer</a>, extracting <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#data-tibble">data tibbles</a>, and adding <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#variable-label">variable labels</a>.</p>
<p>The <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/diving_deeper.html">Diving Deeper vignette</a> explains in detail how REDCapTidieR constructs <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#data-tibble">data tibbles</a>.</p>
<p>We also created a comprehensive <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html">Glossary of REDCap and REDCapTidieR terms</a> to which we will link frequently.</p>
</section>
<section id="hello-metadata" class="level2">
<h2 class="anchored" data-anchor-id="hello-metadata">Hello metadata!</h2>
<p>A key change to REDCapTidieR in v0.2.0 is that the <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#supertibble">supertibble</a> now includes a lot of additional instrument-level metadata.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(REDCapTidieR)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>superheroes <span class="ot">&lt;-</span> <span class="fu">read_redcap</span>(redcap_uri, token)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>superheroes <span class="sc">|&gt;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["redcap_form_name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["redcap_form_label"],"name":[2],"type":["chr"],"align":["left"]},{"label":["redcap_data"],"name":[3],"type":["list"],"align":["right"]},{"label":["redcap_metadata"],"name":[4],"type":["list"],"align":["right"]},{"label":["structure"],"name":[5],"type":["chr"],"align":["left"]},{"label":["data_rows"],"name":[6],"type":["int"],"align":["right"]},{"label":["data_cols"],"name":[7],"type":["int"],"align":["right"]},{"label":["data_size"],"name":[8],"type":["lbstr_by"],"align":["right"]},{"label":["data_na_pct"],"name":[9],"type":["formttbl"],"align":["right"]},{"label":["form_complete_pct"],"name":[10],"type":["formttbl"],"align":["right"]}],"data":[{"1":"heroes_information","2":"Heroes Information","3":"<tibble[,12]>","4":"<tibble[,17]>","5":"nonrepeating","6":"734","7":"12","8":"123.24 kB","9":"0.23%","10":"0%"},{"1":"super_hero_powers","2":"Super Hero Powers","3":"<tibble[,4]>","4":"<tibble[,17]>","5":"repeating","6":"5966","7":"4","8":"180.21 kB","9":"0%","10":"0%"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>REDCapTidieR 0.2.0 provides the following new columns:</p>
<ul>
<li><code>redcap_form_label</code>: a human-readable label for the <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#instrument">instrument</a></li>
<li><code>redcap_metadata</code>: The <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#metadata-tibble">metadata tibble</a> with instrument-level metadata derived from <a href="https://ouhscbbmc.github.io/REDCapR/reference/redcap_metadata_read.html"><code>REDCapR::redcap_metadata_read()</code></a></li>
<li><code>redcap_events</code>: <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#event">Events</a> and <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#arm">arms</a> associated with this instrument (for <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#longitudinal-project">longitudinal projects</a> only)</li>
<li><code>data_rows</code>, <code>data_cols</code>: <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#row">Row</a> and <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#column">column</a> counts of the <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#data-tibble">data tibble</a> (<code>redcap_data</code>)</li>
<li><code>data_size</code>: Size of the <code>redcap_data</code> tibble in memory</li>
<li><code>data_na_pct</code>: The percentage of missing data in the <code>redcap_data</code> tibble</li>
</ul>
</section>
<section id="redcaptidier-labelled" class="level2">
<h2 class="anchored" data-anchor-id="redcaptidier-labelled">REDCapTidieR ❤️ labelled</h2>
<p>The <a href="https://larmarange.github.io/labelled/">labelled</a> R package provides functions to attach a human-readable description (a label) to a <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#variable">variable</a> (a <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#variable-label">variable label</a>). Variable labels are awesome and we think you will find them useful! Take a look at Shannon Pileggi’s blog post <a href="https://www.pipinghotdata.com/posts/2022-09-13-the-case-for-variable-labels-in-r/">The case for variable labels in R</a> to find out more.</p>
<p>REDCapTidieR now provides <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/reference/make_labelled.html"><code>make_labelled()</code></a>, a function that attaches <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#variable-label">variable labels</a> to the <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#supertibble">supertibble</a> and the <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#tibble">tibbles</a> it contains:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>superheroes_labelled <span class="ot">&lt;-</span> superheroes <span class="sc">|&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_labelled</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the RStudio <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#data-viewer">Data Viewer</a>, <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#variable-label">variable labels</a> appear below each <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#column">column</a> name. This makes it easy to inspect the contents of the <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#supertibble">supertibble</a>:</p>
<p><img src="images/labelled_supertibble.png" class="img-fluid" alt="Labelled supertibble"></p>
<p>While the <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#variable-label">variable labels</a> in the <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#supertibble">supertibble</a> are static and pre-defined, variable labels in the <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#data-tibble">data tibbles</a> (<code>redcap_data</code>) are derived from the REDCap <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#field-label">field labels</a>. A field label is a piece of text that prompts the REDCap user during data entry. We repurpose field labels to provide a description for the variable:</p>
<p><img src="images/labelled_tibble.png" class="img-fluid" alt="Labelled tibble"></p>
</section>
<section id="new-arguments-for-read_redcap" class="level2">
<h2 class="anchored" data-anchor-id="new-arguments-for-read_redcap">New arguments for <code>read_redcap()</code></h2>
<p>We have introduced two new arguments that can be passed to the <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/reference/read_redcap.html"><code>read_redcap()</code></a> function:</p>
<ul>
<li><code>forms</code></li>
<li><code>export_survey_fields</code></li>
</ul>
<section id="retrieve-data-from-a-subset-of-instruments" class="level3">
<h3 class="anchored" data-anchor-id="retrieve-data-from-a-subset-of-instruments">Retrieve data from a subset of instruments</h3>
<p>You can now <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#import">import</a> data from specific <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#instrument">instruments</a> from your <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#project">project</a> instead of importing the entire dataset. This can be useful for very large projects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Only import the super_hero_powers instrument</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>superheroes_powers <span class="ot">&lt;-</span> <span class="fu">read_redcap</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  redcap_uri,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  token,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">forms =</span> <span class="st">"super_hero_powers"</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>superheroes_powers <span class="sc">|&gt;</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["redcap_form_name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["redcap_form_label"],"name":[2],"type":["chr"],"align":["left"]},{"label":["redcap_data"],"name":[3],"type":["list"],"align":["right"]},{"label":["redcap_metadata"],"name":[4],"type":["list"],"align":["right"]},{"label":["structure"],"name":[5],"type":["chr"],"align":["left"]},{"label":["data_rows"],"name":[6],"type":["int"],"align":["right"]},{"label":["data_cols"],"name":[7],"type":["int"],"align":["right"]},{"label":["data_size"],"name":[8],"type":["lbstr_by"],"align":["right"]},{"label":["data_na_pct"],"name":[9],"type":["formttbl"],"align":["right"]},{"label":["form_complete_pct"],"name":[10],"type":["formttbl"],"align":["right"]}],"data":[{"1":"super_hero_powers","2":"Super Hero Powers","3":"<tibble[,4]>","4":"<tibble[,17]>","5":"repeating","6":"5966","7":"4","8":"180.21 kB","9":"0%","10":"0%"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="support-for-redcap-surveys" class="level3">
<h3 class="anchored" data-anchor-id="support-for-redcap-surveys">Support for REDCap surveys</h3>
<p>REDCap now supports <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#survey">surveys</a>, which are a special type of <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#instrument">instrument</a> that can be filled out by someone who isn’t a registered user of the REDCap <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#project">project</a>. Instruments that are used as surveys generate additional <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#data-column">data columns</a>:</p>
<ul>
<li><code>redcap_survey_timestamp</code>: the time at which the survey was completed</li>
<li><code>redcap_survey_identifier</code>: the participant identifier (this will be <code>NA</code> if the Participant Identifier feature in REDCap is disabled such as for an anonymous survey)</li>
</ul>
<p>By default, <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/reference/read_redcap.html"><code>read_redcap()</code></a> will now return these <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#column">columns</a> if the <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#instrument">instrument</a> is set up as a <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#survey">survey</a>. Note the <code>redcap_survey_identifier</code> and <code>redcap_survey_timestamp</code> columns below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>survey_database <span class="ot">&lt;-</span> <span class="fu">read_redcap</span>(redcap_uri, survey_token)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>survey_database <span class="sc">|&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_tibble</span>(<span class="st">"survey"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 4
Columns: 9
$ record_id                &lt;dbl&gt; 1, 2, 3, 4
$ survey_yesno             &lt;lgl&gt; TRUE, FALSE, NA, NA
$ survey_radio             &lt;fct&gt; Choice 1, Choice 2, NA, NA
$ survey_checkbox___one    &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE
$ survey_checkbox___two    &lt;lgl&gt; TRUE, TRUE, FALSE, FALSE
$ survey_checkbox___three  &lt;lgl&gt; TRUE, TRUE, FALSE, FALSE
$ redcap_survey_identifier &lt;lgl&gt; NA, NA, NA, NA
$ redcap_survey_timestamp  &lt;dttm&gt; 2022-11-09 10:33:35, NA, NA, NA
$ form_status_complete     &lt;fct&gt; Complete, Incomplete, Incomplete, Incomplete</code></pre>
</div>
</div>
</section>
</section>
<section id="performance-improvements-and-enhancements" class="level2">
<h2 class="anchored" data-anchor-id="performance-improvements-and-enhancements">Performance improvements and enhancements</h2>
<ul>
<li><strong>Improved execution time by &gt;2.5X</strong> by optimizing internal functions</li>
<li>Added many helpful warnings and error messages, using <a href="https://cli.r-lib.org/">cli</a> for pretty printing</li>
<li>Tests and vignettes now use <a href="https://enpiar.com/r/httptest/">httptest</a> to mock and cache REDCap API calls</li>
<li>Implemented GitHub Actions lint check</li>
<li>Replaced deprecated <code>.data</code> pronoun in <a href="https://tidyselect.r-lib.org/reference/language.html">tidyselect</a> expressions</li>
</ul>
</section>
<section id="bug-fixes" class="level2">
<h2 class="anchored" data-anchor-id="bug-fixes">Bug fixes</h2>
<ul>
<li>Fixed a bug in which similarly named variables could be duplicated under some circumstances</li>
<li>Order of instruments in the supertibble is now the same as the order of instruments in REDCap</li>
<li>Fixed an issue in which <code>extract_*</code> functions under some circumstances returned <code>NULL</code> instead of the expected tibbles</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Made with ❤️ in Philadelphia
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>